{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020-01-12-crawling-with-selenium/","result":{"data":{"site":{"siteMetadata":{"title":"Yoonjae Park's Blog"}},"markdownRemark":{"id":"1c5d0de5-2153-5cf0-85f1-5ca4585743f0","excerpt":"데이터를 크롤링 하기 위해서 requests 를 이용해서 진행하다가 스크립트를 이용하여 데이터가 변경되는 사이트가 있어서\njava script를 실행해서 받아 올까 하다가 Selenium을 활용하여 실제 웹 브라우저를 이용해서 진행하였다. 먼저 Chrome driver…","html":"<p>데이터를 크롤링 하기 위해서 requests 를 이용해서 진행하다가 스크립트를 이용하여 데이터가 변경되는 사이트가 있어서\njava script를 실행해서 받아 올까 하다가 Selenium을 활용하여 실제 웹 브라우저를 이용해서 진행하였다.</p>\n<p>먼저 Chrome driver를 다운받아 경로에 두고 다음과 같이 driver를 생성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\noptions <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>ChromeOptions<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">(</span>옵션 설정<span class=\"token punctuation\">)</span>\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token string\">'{}/chromedriver'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>chrome_driver_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> chrome_options<span class=\"token operator\">=</span>options<span class=\"token punctuation\">)</span></code></pre></div>\n<p>브라우저에서 진행할 수 있는 다양한 행동을 함수를 통해서 수행 할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>                       <span class=\"token comment\"># url로 이동</span>\ndriver<span class=\"token punctuation\">.</span>execute_script<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>               <span class=\"token comment\"># java script 실행</span>\ndriver<span class=\"token punctuation\">.</span>set_window_position<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 브라우저 위치 설정</span>\ndriver<span class=\"token punctuation\">.</span>set_window_size<span class=\"token punctuation\">(</span><span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">600</span><span class=\"token punctuation\">)</span>      <span class=\"token comment\"># 브라우저 크기 설정</span>\ndriver<span class=\"token punctuation\">.</span>page_source                    <span class=\"token comment\"># 현재 html 가져오기, 함수가 아님에 유의</span></code></pre></div>\n<p>때로는 웹 페이지가 로드 되기 전이여서 기다려야 할 때가 있다.\n자주 쓰일거 같아서 함수로 만들어 보았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>by <span class=\"token keyword\">import</span> By\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>support <span class=\"token keyword\">import</span> expected_conditions <span class=\"token keyword\">as</span> EC\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span>ui <span class=\"token keyword\">import</span> WebDriverWait\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">wait</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span>By<span class=\"token punctuation\">.</span>NAME<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        WebDriverWait<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>until<span class=\"token punctuation\">(</span>\n            EC<span class=\"token punctuation\">.</span>presence_of_element_located<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span></code></pre></div>\n<p>Chrome option 부분에서 headless 모드로 실행(실제 동작하는 모습을 보여주지 않음)한다던지 프록시 설정을 진행할 수도 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">options<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--proxy-server=%s'</span> <span class=\"token operator\">%</span> PROXY<span class=\"token punctuation\">)</span>\noptions<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'headless'</span><span class=\"token punctuation\">)</span></code></pre></div>","fields":{"slug":"/2020-01-12-crawling-with-selenium/"},"frontmatter":{"title":"Crawling with Selenium","date":"January 12, 2020","description":null}},"previous":{"fields":{"slug":"/2020-01-05-free-services-in-Azure/"},"frontmatter":{"title":"Free Sevices in Azure"}},"next":{"fields":{"slug":"/2020-01-12-setting-squid-proxy/"},"frontmatter":{"title":"Setting Squid Proxy"}}},"pageContext":{"id":"1c5d0de5-2153-5cf0-85f1-5ca4585743f0","previousPostId":"3af8dae5-35a6-543d-97e4-731625664045","nextPostId":"80b4fa09-0739-54d7-8689-fe42fe441527"}},"staticQueryHashes":["3000541721","3667728435"]}